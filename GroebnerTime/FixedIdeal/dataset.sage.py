

# This file was *autogenerated* from the file dataset.sage
from sage.all_cmdline import *   # import sage library

_sage_const_6 = Integer(6); _sage_const_1 = Integer(1); _sage_const_0 = Integer(0); _sage_const_600 = Integer(600); _sage_const_199 = Integer(199); _sage_const_100 = Integer(100)
import random as rand
from timeit import default_timer as timer
import multiprocessing as mp

n = _sage_const_6 
var(['x' + str(i) for i in range(n)])
# Define the generators of the Cyclic(6) ideal
f1 = x0 + x1 + x2 + x3 + x4 + x5
f2 = x0*x1 + x1*x2 + x2*x3 + x3*x4 + x4*x5 + x5*x0
f3 = x0*x1*x2 + x1*x2*x3 + x2*x3*x4 + x3*x4*x5 + x4*x5*x0 + x5*x0*x1
f4 = x0*x1*x2*x3 + x1*x2*x3*x4 + x2*x3*x4*x5 + x3*x4*x5*x0 + x4*x5*x0*x1 + x5*x0*x1*x2
f5 = x0*x1*x2*x3*x4 + x1*x2*x3*x4*x5 + x2*x3*x4*x5*x0 + x3*x4*x5*x0*x1 + x4*x5*x0*x1*x2 + x5*x0*x1*x2*x3
f6 = x0*x1*x2*x3*x4*x5 - _sage_const_1 

def gb_stopwatch(I, time):
    st = timer()
    I.groebner_basis()
    en = timer()
    time.value = en - st

def test_case(A, time_limit):
    T = TermOrder(A)
    R = PolynomialRing(QQ, 'x', n, order=T)
    # print(T)
    # print(x0 > x1)
    # print(R)
    # print(TermOrder(A))
    I = R.ideal([f1, f2, f3, f4, f5, f6])

    time = mp.Value('d', time_limit)
    process = mp.Process(target=gb_stopwatch, args=(I, time, ))
    process.start()
    process.join(timeout=time_limit)

    if process.is_alive():
        process.terminate()
        process.join()

    return time.value

def main():
    s = timer()
    totaltime = _sage_const_0 
    TIME_LIMIT = _sage_const_600 
    NUM_SAMPLES = _sage_const_199 
    MATRIX_ENTRY_SIZE = _sage_const_100 
    with open('data.txt', 'a') as f:
        for i in range(NUM_SAMPLES):
            # too-large matrix coefs may cause overflow issues or speed issues
            A = matrix(n, [rand.randint(_sage_const_1 , MATRIX_ENTRY_SIZE) for _ in range(n*n)],
                       immutable=True)
            result = test_case(A, TIME_LIMIT)
            totaltime += result
            print(f'run number {i}: The current runtime is {totaltime} seconds.', end=' ')
            if result == TIME_LIMIT:
                print('The previous computation timed out.')
            else:
                print(f'The previous computation took {result} seconds.')
            print(f'ETA: {totaltime/(i+_sage_const_1 ) * (_sage_const_199  - i)} seconds')
            to_write = ""
            for B in A:
                for j in B:
                    to_write += str(j) + " "
            to_write += str(result)
            to_write += "\n"
            f.write(to_write)
    
    print(f'The total runtime was {totaltime} seconds.')

if __name__ == "__main__":
    main()

